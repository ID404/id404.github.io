---
    title: 利用批处理设置静态IP、动态IP、手动设置IP
    date: 2014-06-25 20:37:00
    updated: 2017-12-10 10:48:00
    abbrlink: 4306896
    tags:
    categories:
    ---
    <div>
<div>
<div id="sina_keyword_ad_area2" class="articalContent   newfont_family">
<p>懒人必备，轻松点击就可以更改ip</p>
<p>&nbsp;</p>
<p>假设需要更改ip地址的网卡名为&ldquo;本地连接&rdquo;</p>
<p>&nbsp;</p>
<p>设置静态ip:</p>
<p>假设</p>
<p>ip地址：192.168.0.128</p>
<p>子网掩码：255.255.255.0</p>
<p>网关：192.168.0.2</p>
<p>DNS:8.8.8.8</p>
<p>新建一个文本文件名为ip static.txt</p>
<p>将以下全码复制到文件内：</p>
<p>[code]</p>
<p>@echo 正在设置固定ip,请稍候&hellip;&hellip;</p>
<p>netsh interface ip set address 本地连接 source=static addr=192.168.0.128 mask=255.255.255.0</p>
<p>netsh interface ip set address name=本地连接 gateway=192.168.0.2 gwmetric=1</p>
<p>netsh interface ip set dns 本地连接 static 8.8.8.8</p>
<p>@echo 固定ip已设置完毕</p>
<p>@pause</p>
<p>[/code]</p>
<p>将文件名改为ip static.bat</p>
<p>双击打开批处理即可更改ip地址</p>
<p>&nbsp;</p>
<p>设置动态ip:</p>
<p>同样假设网卡名为&ldquo;本地连接&rdquo;</p>
<p>新建一个文本文件名为ip dhcp.txt</p>
<p>将以下全码复制到文件内：</p>
<p>[code]</p>
<p>@echo 自动获取ip地址</p>
<p>netsh int ip set add name="本地连接" source=dhcp</p>
<p>@echo 自动获取DNS服务器</p>
<p>netsh int ip set dns name="本地连接" source=dhcp</p>
<p>@echo 自动获取ip地址设置完毕</p>
<p>@pause</p>
<p>[/code]</p>
<p>将文件名改为ip dhcp.bat</p>
<p>双击打开批处理即可更改ip地址</p>
<p>&nbsp;</p>
<p>手动设置IP信息：</p>
<p>有时一步一步点击进控制面板&mdash;&mdash;网络接连&mdash;&mdash;本地连接属性&mdash;&mdash;tcp/ip协议更改ip地址会显得很麻烦，其实可以轻松建一个批处理放在桌面，只要双击输入ip信息就可以轻松更改ip</p>
<p>&nbsp;</p>
<p>同样假设网卡名为&ldquo;本地连接&rdquo;</p>
<p>新建一个文本文件名为ip_setting.txt</p>
<p>将以下全码复制到文件内：</p>
<p>[code]</p>
<p>@echo 正在设置固定ip,请稍候&hellip;&hellip;</p>
<p>&nbsp;</p>
<p>@echo 请输入ip地址：</p>
<p>set /p ip=</p>
<p>@echo ！</p>
<p>@echo 请输入网关：</p>
<p>set /p gw=</p>
<p>@echo ！</p>
<p>@echo 请输入首选DNS：</p>
<p>set /p DNS1=</p>
<p>&nbsp;</p>
<p>netsh interface ip set address 本地连接 source=static addr=%ip% mask=255.255.255.0</p>
<p>netsh interface ip set address name=本地连接 gateway=%gw% gwmetric=1</p>
<p>netsh interface ip set dns 本地连接 static %DNS1%&nbsp;</p>
<p>&nbsp;</p>
<p>@echo ip地址设置完毕</p>
<p>@pause</p>
<p>&nbsp;</p>
<p>[/code]</p>
<p>将文件名改为ip_setting.bat</p>
<p>双击打开批处理即可更改ip地址</p>
<p>&nbsp;</p>
<p>2014-6-26小小更新一下，将以上三个批处理整合为一个</p>
<p>[code]</p>
<p>@echo off</p>
<p>&nbsp;</p>
<p>goto menu</p>
<p>&nbsp;</p>
<p>:menu</p>
<p>@echo 0. 自动获取ip地址</p>
<p>@echo 1. 修改ip为192.168.0.128</p>
<p>@echo 2. 手动输入ip地址</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>@echo 认修改ip为自动获取[直接回车]</p>
<p>@echo 请选择</p>
<p>&nbsp;</p>
<p>set selc=0</p>
<p>set /p selc=</p>
<p>&nbsp;</p>
<p>@echo 正在设置...</p>
<p>&nbsp;</p>
<p>IF %selc%==0 goto DHCP</p>
<p>IF %selc%==1 goto ipstatic&nbsp;</p>
<p>IF %selc%==2 goto ipsetting</p>
<p>IF %selc% NEQ 2 goto error</p>
<p>exit</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>:error</p>
<p>cls</p>
<p>goto menu</p>
<p>exit</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>:DHCP</p>
<p>@echo 自动获取ip地址</p>
<p>netsh int ip set add name="本地连接" source=dhcp</p>
<p>@echo 自动获取DNS服务器</p>
<p>netsh int ip set dns name="本地连接" source=dhcp</p>
<p>@echo 自动获取ip地址设置完毕</p>
<p>@pause</p>
<p>exit</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>:ipstatic</p>
<p>@echo 设置为192.168.0.128</p>
<p>netsh int ip set add "本地连接" static 192.168.0.128 255.255.255.0 192.168.0.2 1</p>
<p>@echo 正在设置DNS服务器：8.8.8.8</p>
<p>netsh int ip set dns name="本地连接" source=static 8.8.8.8</p>
<p>@echo 静态ip设置完毕</p>
<p>@pause</p>
<p>exit</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>:ipsetting</p>
<p>@echo 正在设置固定ip,请稍候&hellip;&hellip;</p>
<p>&nbsp;</p>
<p>@echo 请输入ip地址：</p>
<p>set /p ip=</p>
<p>@echo ！</p>
<p>@echo 请输入网关：</p>
<p>set /p gw=</p>
<p>@echo ！</p>
<p>@echo 请输入首选DNS：</p>
<p>set /p DNS1=</p>
<p>&nbsp;</p>
<p>netsh interface ip set address 本地连接 source=static addr=%ip% mask=255.255.255.0</p>
<p>netsh interface ip set address name=本地连接 gateway=%gw% gwmetric=1</p>
<p>netsh interface ip set dns 本地连接 static %DNS1%</p>
<p>&nbsp;</p>
<p>@echo ip地址设置完毕</p>
<p>@pause</p>
<p>exit</p>
<p>[/code]</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>2014－6－27 再小小更新一下</p>
<p>鉴于以上脚本只能设置一个默认的本地连接网卡，对于笔记本等装有虚拟机的电脑有多网卡设置起来不方便，简单更改一下后可以设置多网卡的ip</p>
<p>[code]</p>
<p>@echo off</p>
<p>goto menu1</p>
<p>&nbsp;</p>
<p>:menu1</p>
<p>@echo.</p>
<p>@echo.</p>
<p>@echo &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;========================================</p>
<p>@echo.</p>
<p>@echo &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 1.设置无线网卡</p>
<p>@echo &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 2.设置vEthernet</p>
<p>@echo &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 3.设置有线网卡</p>
<p>@echo &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 4.设置无线网卡D-link</p>
<p>@echo &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 5.手动输入网卡名</p>
<p>@echo.</p>
<p>@echo &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;========================================</p>
<p>@echo.</p>
<p>@echo &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;默认设置无线网卡[直接回车]</p>
<p>@echo. &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p>
<p>@echo &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;请选择[1、2、3、4、5]</p>
<p>&nbsp;</p>
<p>set num=1</p>
<p>set /p num=</p>
<p>&nbsp;</p>
<p>IF %num%==1 (</p>
<p>set inter=Wi-Fi</p>
<p>goto menu2)</p>
<p>&nbsp;</p>
<p>IF %num%==2 (</p>
<p>set inter=vEthernet</p>
<p>goto menu2)</p>
<p>&nbsp;</p>
<p>IF %num%==3 (</p>
<p>set inter=以太网</p>
<p>goto menu2)</p>
<p>&nbsp;</p>
<p>IF %num%==4 (</p>
<p>set inter=Wi-Fi 2</p>
<p>goto menu2)</p>
<p>&nbsp;</p>
<p>IF %num%==5 (</p>
<p>@echo 请输入网卡名</p>
<p>set /p inter=</p>
<p>goto menu2)</p>
<p>&nbsp;</p>
<p>IF %nmu% NEQ 5 goto err1</p>
<p>&nbsp;</p>
<p>exit</p>
<p>&nbsp;</p>
<p>:err1</p>
<p>cls</p>
<p>goto menu1</p>
<p>exit</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>:menu2</p>
<p>@echo.</p>
<p>@echo.</p>
<p>@echo &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;========================================</p>
<p>@echo.</p>
<p>@echo &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1. 自动获取ip地址</p>
<p>@echo &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;2. 修改ip为192.168.0.128</p>
<p>@echo &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;3. 手动输入ip地址</p>
<p>@echo.</p>
<p>@echo &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;========================================</p>
<p>@echo.&nbsp;</p>
<p>@echo &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;默认修改ip为自动获取[直接回车]</p>
<p>@echo.</p>
<p>@echo &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;请选择[1、2、3]</p>
<p>&nbsp;</p>
<p>set selc=1</p>
<p>set /p selc=</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>@echo 正在设置...</p>
<p>&nbsp;</p>
<p>IF %selc%==1 goto DHCP</p>
<p>IF %selc%==2 goto ipstatic&nbsp;</p>
<p>IF %selc%==3 goto ipsetting</p>
<p>IF %selc% NEQ 2 goto err2</p>
<p>exit</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>:err2</p>
<p>cls</p>
<p>goto menu2</p>
<p>exit</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>:DHCP</p>
<p>@echo.</p>
<p>@echo 自动获取ip地址</p>
<p>netsh int ip set add name="%inter%" source=dhcp</p>
<p>@echo 自动获取DNS服务器</p>
<p>netsh int ip set dns name="%inter%" source=dhcp</p>
<p>@echo 自动获取ip地址设置完毕</p>
<p>@echo.</p>
<p>@echo.</p>
<p>@pause</p>
<p>exit</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>:ipstatic</p>
<p>@echo 设置为192.168.0.128</p>
<p>netsh int ip set add "%inter%" static 192.168.0.128 255.255.255.0 192.168.0.2 1</p>
<p>@echo 正在设置DNS服务器：8.8.8.8</p>
<p>netsh int ip set dns name="%inter%" source=static 8.8.8.8</p>
<p>netsh int ip add dns name="%inter%" 114.114.114.114 index=2</p>
<p>@echo 静态ip设置完毕</p>
<p>@echo.</p>
<p>@echo.</p>
<p>@pause</p>
<p>exit</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>:ipsetting</p>
<p>@echo 正在设置固定ip,请稍候&hellip;&hellip;</p>
<p>@echo.</p>
<p>@echo 请输入ip地址：</p>
<p>set /p ip=</p>
<p>@echo.</p>
<p>@echo.</p>
<p>@echo 请输入网关：</p>
<p>set /p gw=</p>
<p>@echo.</p>
<p>netsh interface ip set address "%inter%" static %ip% 255.255.255.0 %gw% 1</p>
<p>&nbsp;</p>
<p>@echo 请输入首选DNS：</p>
<p>set /p DNS1=</p>
<p>@echo.</p>
<p>@echo.</p>
<p>@echo 请输入备用DNS：</p>
<p>set /p DNS2=</p>
<p>&nbsp;</p>
<p>netsh interface ip set dns name="%inter%" source=static %DNS1%</p>
<p>netsh int ip add dns name="%inter%" %DNS2% index=2</p>
<p>&nbsp;</p>
<p>@echo ip地址设置完毕</p>
<p>@echo.</p>
<p>@echo.</p>
<p>@pause</p>
<p>exit</p>
<p>[/code]</p>
<div>&nbsp;</div>
<div>第二次修改</div>
<div>
<div class="cnblogs_code">
<pre><span style="color: #000000;">@echo off</span></pre>
<p>&nbsp; &gt;NUL 2&gt;&amp;1 REG.exe query "HKU\S-1-5-19" || (<br />&nbsp; &nbsp; &nbsp; ECHO SET UAC = CreateObject^("Shell.Application"^) &gt; "%TEMP%\Getadmin.vbs"<br />&nbsp; &nbsp; &nbsp; ECHO UAC.ShellExecute "%~f0", "%1", "", "runas", 1 &gt;&gt; "%TEMP%\Getadmin.vbs"<br />&nbsp; &nbsp; &nbsp; "%TEMP%\Getadmin.vbs"<br />&nbsp; &nbsp; &nbsp; DEL /f /q "%TEMP%\Getadmin.vbs" 2&gt;NUL<br />&nbsp; &nbsp; &nbsp; Exit /b<br />&nbsp; )</p>
<pre><span style="color: #000000;"><br /><br />title IP地址快速修改
color 1E

mode con cols</span>=<span style="color: #800080;">80</span> lines=<span style="color: #800080;">30</span><span style="color: #000000;">
goto menu1
 
:menu1
@echo.
@echo.
@echo                </span>========================================<span style="color: #000000;">
@echo.
@echo                             </span><span style="color: #800080;">1</span><span style="color: #000000;">.设置无线网卡
@echo                             </span><span style="color: #800080;">2</span><span style="color: #000000;">.设置vEthernet
@echo                             </span><span style="color: #800080;">3</span><span style="color: #000000;">.设置有线网卡
@echo                             </span><span style="color: #800080;">4</span>.设置无线网卡D-<span style="color: #000000;">link
@echo                             </span><span style="color: #800080;">5</span><span style="color: #000000;">.手动输入网卡名
@echo                             </span><span style="color: #800080;">6</span><span style="color: #000000;">.查看网卡ip地址
@echo                             </span><span style="color: #800080;">7</span>.设置有线ip为192.<span style="color: #800080;">168.0</span>.<span style="color: #800080;">2</span><span style="color: #000000;">
@echo                             </span><span style="color: #800080;">8</span>.设置有线ip为192.<span style="color: #800080;">168.1</span>.<span style="color: #800080;">2</span><span style="color: #000000;">
@echo                             </span><span style="color: #800080;">9</span>.设置有线ip为10.<span style="color: #800080;">252.252</span>.<span style="color: #800080;">25</span><span style="color: #000000;">
@echo                             </span><span style="color: #800080;">10</span><span style="color: #000000;">.退出
@echo.
@echo                </span>========================================<span style="color: #000000;">
@echo.
@echo                        默认设置无线网卡[直接回车]
@echo.                               
@echo                        请选择[</span><span style="color: #800080;">1</span>、<span style="color: #800080;">2</span>、<span style="color: #800080;">3</span>、<span style="color: #800080;">4</span>、<span style="color: #800080;">5</span><span style="color: #000000;">...]

set num</span>=<span style="color: #800080;">1</span><span style="color: #000000;">
set </span>/p num=<span style="color: #000000;">

IF </span>%num%==<span style="color: #800080;">1</span><span style="color: #000000;"> (
set inter</span>=<span style="color: #000000;">WLAN
goto menu2)

IF </span>%num%==<span style="color: #800080;">2</span><span style="color: #000000;"> (
set inter</span>=<span style="color: #000000;">vEthernet
goto menu2)

IF </span>%num%==<span style="color: #800080;">3</span><span style="color: #000000;"> (
set inter</span>=<span style="color: #000000;">以太网
goto menu2)

IF </span>%num%==<span style="color: #800080;">4</span><span style="color: #000000;"> (
set inter</span>=Wi-Fi <span style="color: #800080;">2</span><span style="color: #000000;">
goto menu2)

IF </span>%num%==<span style="color: #800080;">5</span><span style="color: #000000;"> (
@echo 请输入网卡名
set </span>/p inter=<span style="color: #000000;">
goto menu2)

IF </span>%num%==<span style="color: #800080;">6</span><span style="color: #000000;"> goto ipadd

IF </span>%num%==<span style="color: #800080;">7</span><span style="color: #000000;"> goto wire0

IF </span>%num%==<span style="color: #800080;">8</span><span style="color: #000000;"> goto wire1

IF </span>%num%==<span style="color: #800080;">9</span><span style="color: #000000;"> goto wire252

IF </span>%num%==<span style="color: #800080;">10</span><span style="color: #000000;"> exit

IF </span>%num% NEQ <span style="color: #800080;">10</span><span style="color: #000000;"> (
@echo 输入有误
@pause
goto err1)

exit

:ipadd
ipconfig </span>/all | <span style="color: #0000ff;">find</span> /i <span style="color: #800000;">"</span><span style="color: #800000;">IPv4</span><span style="color: #800000;">"</span><span style="color: #000000;">
@echo.
ipconfig </span>/all | <span style="color: #0000ff;">find</span> /i <span style="color: #800000;">"</span><span style="color: #800000;">子网掩码</span><span style="color: #800000;">"</span><span style="color: #000000;">
@echo.
ipconfig </span>/all | <span style="color: #0000ff;">find</span> /i <span style="color: #800000;">"</span><span style="color: #800000;">网关</span><span style="color: #800000;">"</span><span style="color: #000000;">
@echo.
ipconfig </span>/all | <span style="color: #0000ff;">find</span> /i <span style="color: #800000;">"</span><span style="color: #800000;">DNS 服务器</span><span style="color: #800000;">"</span><span style="color: #000000;">
@pause
goto menu1


:err1
cls
goto menu1
exit
 


:menu2
@echo.
@echo.
@echo                </span>========================================<span style="color: #000000;">
@echo.
@echo                          </span><span style="color: #800080;">1</span><span style="color: #000000;">. 自动获取ip地址
@echo                          </span><span style="color: #800080;">2</span>. 修改ip为192.<span style="color: #800080;">168.5</span>.<span style="color: #800080;">123</span><span style="color: #000000;">
@echo                          </span><span style="color: #800080;">3</span><span style="color: #000000;">. 手动输入ip地址
@echo                          </span><span style="color: #800080;">4</span><span style="color: #000000;">. 手动设置DNS
@echo                          </span><span style="color: #800080;">5</span><span style="color: #000000;">. 自动获取DNS
@echo                          </span><span style="color: #800080;">6</span><span style="color: #000000;">. 更改为阿里DNS
@echo                          </span><span style="color: #800080;">7</span>. 更改为127.<span style="color: #800080;">0.0</span>.<span style="color: #800080;">1</span><span style="color: #000000;">
@echo                          </span><span style="color: #800080;">8</span><span style="color: #000000;">. 只设置IP地址，不设置网关
@echo.
@echo                </span>========================================<span style="color: #000000;">
@echo. 
@echo                      默认修改ip为自动获取[直接回车]
@echo.
@echo                      请选择[</span><span style="color: #800080;">1</span>、<span style="color: #800080;">2</span>、<span style="color: #800080;">3</span><span style="color: #000000;">]
 
set selc</span>=<span style="color: #800080;">1</span><span style="color: #000000;">
set </span>/p selc=<span style="color: #000000;">

 
@echo 正在设置...
 
IF </span>%selc%==<span style="color: #800080;">1</span><span style="color: #000000;"> goto DHCP
IF </span>%selc%==<span style="color: #800080;">2</span><span style="color: #000000;"> goto ipstatic 
IF </span>%selc%==<span style="color: #800080;">3</span><span style="color: #000000;"> goto ipsetting
IF </span>%selc%==<span style="color: #800080;">4</span><span style="color: #000000;"> goto DNS1
IF </span>%selc%==<span style="color: #800080;">5</span><span style="color: #000000;"> goto DNS2
IF </span>%selc%==<span style="color: #800080;">6</span><span style="color: #000000;"> goto DNSAL
IF </span>%selc%==<span style="color: #800080;">7</span><span style="color: #000000;"> goto DNS127
IF </span>%selc%==<span style="color: #800080;">8</span><span style="color: #000000;"> goto IPONLY
IF </span>%selc% NEQ <span style="color: #800080;">8</span><span style="color: #000000;"> goto err2
exit
 
 
:err2
cls
goto menu2
exit
 
:wire0
@echo 正在设置固定ip_192.</span><span style="color: #800080;">168.0</span>.<span style="color: #800080;">2</span><span style="color: #000000;">,请稍候&hellip;&hellip;
@echo.
@echo.
@echo.
@echo.
netsh interface ip set address </span><span style="color: #800000;">"</span><span style="color: #800000;">以太网</span><span style="color: #800000;">"</span> static <span style="color: #800080;">192.168</span>.<span style="color: #800080;">0.2</span> <span style="color: #800080;">255.255</span>.<span style="color: #800080;">255.0</span> <span style="color: #800080;">192.168</span>.<span style="color: #800080;">0.1</span> <span style="color: #800080;">1</span><span style="color: #000000;">
@pause
goto menu1

:wire1
:wire0
@echo 正在设置固定ip_192.</span><span style="color: #800080;">168.1</span>.<span style="color: #800080;">2</span><span style="color: #000000;">,请稍候&hellip;&hellip;
@echo.
@echo.
@echo.
@echo.
netsh interface ip set address </span><span style="color: #800000;">"</span><span style="color: #800000;">以太网</span><span style="color: #800000;">"</span> static <span style="color: #800080;">192.168</span>.<span style="color: #800080;">1.2</span> <span style="color: #800080;">255.255</span>.<span style="color: #800080;">255.0</span> <span style="color: #800080;">192.168</span>.<span style="color: #800080;">1.1</span> <span style="color: #800080;">1</span><span style="color: #000000;">
@pause
goto menu1

:wire252
:wire0
@echo 正在设置固定ip_10.</span><span style="color: #800080;">252.252</span>.<span style="color: #800080;">25</span><span style="color: #000000;">,请稍候&hellip;&hellip;
@echo.
@echo.
@echo.
@echo.
netsh interface ip set address </span><span style="color: #800000;">"</span><span style="color: #800000;">以太网</span><span style="color: #800000;">"</span> static <span style="color: #800080;">10.252</span>.<span style="color: #800080;">252.25</span> <span style="color: #800080;">255.255</span>.<span style="color: #800080;">255.0</span> <span style="color: #800080;">10.252</span>.<span style="color: #800080;">252.252</span> <span style="color: #800080;">1</span><span style="color: #000000;">
@pause
goto menu1
 
:DHCP
@echo.
@echo 自动获取ip地址
netsh </span><span style="color: #0000ff;">int</span> ip set add name=<span style="color: #800000;">"</span><span style="color: #800000;">%inter%</span><span style="color: #800000;">"</span> source=<span style="color: #000000;">dhcp
@echo 自动获取DNS服务器
netsh </span><span style="color: #0000ff;">int</span> ip set dns name=<span style="color: #800000;">"</span><span style="color: #800000;">%inter%</span><span style="color: #800000;">"</span> source=<span style="color: #000000;">dhcp
@echo 自动获取ip地址设置完毕
@echo.
@echo.
@pause
goto menu1
 
 
 
:ipstatic
@echo 设置为192.</span><span style="color: #800080;">168.5</span>.<span style="color: #800080;">123</span><span style="color: #000000;">
netsh </span><span style="color: #0000ff;">int</span> ip set add <span style="color: #800000;">"</span><span style="color: #800000;">%inter%</span><span style="color: #800000;">"</span> static <span style="color: #800080;">192.168</span>.<span style="color: #800080;">5.123</span> <span style="color: #800080;">255.255</span>.<span style="color: #800080;">255.0</span> <span style="color: #800080;">192.168</span>.<span style="color: #800080;">5.1</span> <span style="color: #800080;">1</span><span style="color: #000000;">
@echo 正在设置DNS服务器：</span><span style="color: #800080;">192.168</span>.<span style="color: #800080;">5.1</span><span style="color: #000000;">
netsh </span><span style="color: #0000ff;">int</span> ip set dns name=<span style="color: #800000;">"</span><span style="color: #800000;">%inter%</span><span style="color: #800000;">"</span> source=static <span style="color: #800080;">192.168</span>.<span style="color: #800080;">5.1</span><span style="color: #000000;">
netsh </span><span style="color: #0000ff;">int</span> ip add dns name=<span style="color: #800000;">"</span><span style="color: #800000;">%inter%</span><span style="color: #800000;">"</span> <span style="color: #800080;">114.114</span>.<span style="color: #800080;">114.114</span> index=<span style="color: #800080;">2</span><span style="color: #000000;">
@echo 静态ip设置完毕
@echo.
@echo.
@pause
goto menu1
 
 
:ipsetting
@echo 正在设置固定ip,请稍候&hellip;&hellip;
@echo.
@echo 请输入ip地址：
set </span>/p ip=<span style="color: #000000;">
@echo.
@echo.
@echo 请输入网关：
set </span>/p gw=<span style="color: #000000;">
@echo.
netsh interface ip set address </span><span style="color: #800000;">"</span><span style="color: #800000;">%inter%</span><span style="color: #800000;">"</span> static %ip% <span style="color: #800080;">255.255</span>.<span style="color: #800080;">255.0</span> %gw% <span style="color: #800080;">1</span><span style="color: #000000;">

@echo 请输入首选DNS：
set </span>/p DNS1=<span style="color: #000000;">
@echo.
@echo.
@echo 请输入备用DNS：
set </span>/p DNS2=<span style="color: #000000;">

netsh interface ip set dns name</span>=<span style="color: #800000;">"</span><span style="color: #800000;">%inter%</span><span style="color: #800000;">"</span> source=static %DNS1%<span style="color: #000000;">
netsh </span><span style="color: #0000ff;">int</span> ip add dns name=<span style="color: #800000;">"</span><span style="color: #800000;">%inter%</span><span style="color: #800000;">"</span> %DNS2% index=<span style="color: #800080;">2</span><span style="color: #000000;">
 
@echo ip地址设置完毕
@echo.
@echo.
@pause
exit

:IPONLY
@echo 正在设置固定ip,请稍候&hellip;&hellip;
@echo.
@echo 请输入ip地址：
set </span>/p ip=<span style="color: #000000;">
@echo.
@echo.
netsh interface ip set address </span><span style="color: #800000;">"</span><span style="color: #800000;">%inter%</span><span style="color: #800000;">"</span> static %ip% <span style="color: #800080;">255.255</span>.<span style="color: #800080;">255.0</span><span style="color: #000000;">
 
@echo ip地址设置完毕
@echo.
@echo.
@pause
exit



:DNS1
@echo 请输入首选DNS：
set </span>/p DNS1=<span style="color: #000000;">
@echo.
@echo.
@echo 请输入备用DNS：
set </span>/p DNS2=<span style="color: #000000;">

@echo 正在设置DNS

netsh interface ip set dns name</span>=<span style="color: #800000;">"</span><span style="color: #800000;">%inter%</span><span style="color: #800000;">"</span> source=static %DNS1%<span style="color: #000000;">
netsh </span><span style="color: #0000ff;">int</span> ip add dns name=<span style="color: #800000;">"</span><span style="color: #800000;">%inter%</span><span style="color: #800000;">"</span> %DNS2% index=<span style="color: #800080;">2</span><span style="color: #000000;">
 
@echo DNS设置完毕
@echo.
@echo.
@pause
goto menu1


:DNS2
@echo 正在设置DNS为自动获取
netsh interface ip set dns name</span>=<span style="color: #800000;">"</span><span style="color: #800000;">%inter%</span><span style="color: #800000;">"</span> source=<span style="color: #000000;">dhcp
@echo DNS设置完毕
@pause
goto menu1

:DNSAL
@echo 正在设置为阿里DNS

netsh interface ip set dns name</span>=<span style="color: #800000;">"</span><span style="color: #800000;">%inter%</span><span style="color: #800000;">"</span> source=static <span style="color: #800080;">223.5</span>.<span style="color: #800080;">5.5</span><span style="color: #000000;">
netsh </span><span style="color: #0000ff;">int</span> ip add dns name=<span style="color: #800000;">"</span><span style="color: #800000;">%inter%</span><span style="color: #800000;">"</span> <span style="color: #800080;">223.6</span>.<span style="color: #800080;">6.6</span> index=<span style="color: #800080;">2</span><span style="color: #000000;">
 
@echo DNS设置完毕
@echo.
@echo.
@pause
goto menu1

:DNS127
@echo 正在设置为127.</span><span style="color: #800080;">0.0</span>.<span style="color: #800080;">1</span><span style="color: #000000;">

netsh interface ip set dns name</span>=<span style="color: #800000;">"</span><span style="color: #800000;">%inter%</span><span style="color: #800000;">"</span> source=static <span style="color: #800080;">127.0</span>.<span style="color: #800080;">0.1</span><span style="color: #000000;">

 
@echo DNS设置完毕
@echo.
@echo.
@pause
goto menu1</span></pre>
</div>
<p>&nbsp;</p>
</div>
</div>
</div>
</div>
    